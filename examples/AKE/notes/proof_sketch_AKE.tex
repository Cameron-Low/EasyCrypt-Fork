\documentclass[]{article}

\usepackage{enumerate}
\usepackage{amsmath}

\newtheorem{definition}{Definition}

\begin{document}

\title{AKE proof sketch}
\author{}
\maketitle

% misc
\newcommand{\tr}{\mathit{tr}}

% events
\newcommand{\StaticRev}{\mathsf{StaticRev}}
\newcommand{\EphemeralRev}{\mathsf{EphemeralRev}}
\newcommand{\SessionRev}{\mathsf{SessionRev}}
\newcommand{\Start}{\mathsf{Start}}
\newcommand{\Accept}{\mathsf{Accept}}
\newcommand{\Init}{\mathsf{Init_1}}
\newcommand{\Initt}{\mathsf{Init_2}}
\newcommand{\Resp}{\mathsf{Resp}}

% types
\newcommand{\psid}{\mathit{psid}}
\newcommand{\sid}{\mathit{sid}}
\newcommand{\agent}{\mathit{agent}}

% session data
\newcommand{\actor}[1]{#1_{\mathit{actor}}}
\newcommand{\role}[1]{#1_{\mathit{role}}}
\newcommand{\peer}[1]{#1_{\mathit{peer}}}
\newcommand{\sent}[1]{#1_{\mathit{sent}}}
\newcommand{\rcvd}[1]{#1_{\mathit{rcvd}}}

\section{The eCK model}

For a session $t$, we use $\actor{t}$, $\role{t}$, $\peer{t}$ to denote the
  actor, the role, and the (intended) peer.
We use $\sent{t}$ to denote $t$'s ephemeral public key and $\rcvd{t}$ to denote
  the received ephemeral public key.

We define the matching relation between completed sessions as follows. \\
\begin{definition}
\begin{align*}
 &  t \textnormal{ matches } s \text{ iff } \\
 &  \actor{t} = \peer{s} \land
    \peer{t} = \actor{s} \land
    \role{t} \neq \role{s} \land
    \sent{t} = \rcvd{s} \land
    \rcvd{t} = \sent{s}
\end{align*}
\end{definition}

The following events can occur in the trace.
\begin{description}
\item[$\StaticRev(\hat{A} : \agent)$:] Static secret key of agent $\hat{A}$ revealed.
\item[$\EphemeralRev(s : \psid)$:] Ephemeral secret key of session with partial session
  id $s$ revealed.
\item[$\SessionRev(s : \sid)$:] Session key of session with session id $s$ revealed.
\item[$\Accept(s : \sid)$:] Session with session id $s$ accepts session key.
\end{description}

\begin{definition}
We say a test session $t$ is fresh with respect to a trace $\tr$ if each of the following
  statements hold:
\begin{enumerate}
\item $\SessionRev(t) \notin \tr$.
\item $\neg (\EphemeralRev(t) \in \tr \land \StaticRev(\actor{t}) \in \tr)$.
\item $t$ has a matching session $s$ and
  \begin{enumerate}[a)]
    \item $\SessionRev(s) \notin \tr$.
    \item $\neg (\EphemeralRev(s) \in \tr \land \StaticRev(\peer{t}) \in \tr)$.
  \end{enumerate}
\item $t$ has no matching session $s$ and $\StaticRev(\peer{t}) \notin \tr$.
\end{enumerate}
\end{definition}

\section{Initial Game}

The main function is defined as
\begin{align*}
& t \leftarrow A_1(pks) \\
& b \leftarrow\!\!\small{\$} \; \{0,1\} \\
& b' \leftarrow A_2(b\, ?\, sessionkey(t) : r)
\end{align*}
where the adversary has access to $h_1^A$, $h_2^A$, $\StaticRev$,
  $\EphemeralRev$, $\SessionRev$, $\Init$, $\Initt$, and $\Resp$.

\newcommand{\Ake}{\mathsf{AKE}}
\newcommand{\Ev}[1]{\mathit{Ev}_{#1}}
\newcommand{\fresh}{\mathit{fresh}}

\end{document}





